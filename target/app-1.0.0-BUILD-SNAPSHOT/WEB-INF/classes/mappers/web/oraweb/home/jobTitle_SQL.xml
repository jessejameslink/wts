<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.vn.app.webmain.oraweb.home.service.impl.JobTitleDAO">

	<select id="getAllJobTitle" resultType="JobTitleVO" parameterType="SearchVO">
		SELECT id, created, lastdate, location, title
		FROM (SELECT A.id, A.created, A.lastdate, A.location, A.title, ROW_NUMBER() OVER(ORDER BY A.created DESC) AS NUM
			  FROM DATA_JOB A
			  WHERE SUBSTR (A.path,1,5) =  CASE #{lang} WHEN 'vi_VN' THEN 'vi-VN'
                                            				  WHEN 'en_US' THEN 'en-US'
                                            				  WHEN 'kr_KR' THEN 'kr-KR'
                                            				  ELSE 'vi-VN' END
              AND A.publishdate between TO_DATE (#{startDate}, 'yyyy/mm/dd') AND TO_DATE (#{endDate}, 'yyyy/mm/dd') + 1
		)
		WHERE NUM BETWEEN (( #{page} - 1 ) * 20 + 1) AND (( #{page} ) * 20 )
	</select>
	
	<select id="getJobTitleCnt" resultType="integer" parameterType="SearchVO">
		SELECT COUNT(*) as CNT
		FROM DATA_JOB A
		WHERE SUBSTR (A.path,1,5) =  CASE #{lang} WHEN 'vi_VN' THEN 'vi-VN'
	                                          		    WHEN 'en_US' THEN 'en-US'
	                                          			WHEN 'kr_KR' THEN 'kr-KR'
	                                          			ELSE 'vi-VN' END
	    AND A.publishdate between TO_DATE (#{startDate}, 'yyyy/mm/dd') AND TO_DATE (#{endDate}, 'yyyy/mm/dd') + 1
	</select>
	
	<select id="getJobTitle" resultType="JobTitleVO" parameterType="SearchVO">
		SELECT id, created, lastdate, location, title
		FROM (SELECT A.id, A.created, A.lastdate, A.location, A.title, ROW_NUMBER() OVER(ORDER BY A.created DESC) AS NUM
			  FROM DATA_JOB A
			  WHERE SUBSTR (A.path,1,5) =  CASE #{lang} WHEN 'vi_VN' THEN 'vi-VN'
                                            				  WHEN 'en_US' THEN 'en-US'
                                            				  WHEN 'kr_KR' THEN 'kr-KR'
                                            				  ELSE 'vi-VN' END 
		)
		WHERE NUM &lt;= 2
	</select>
	
	<select id="getJobTitleDetail" resultType="JobTitleVO"  parameterType="string">
		SELECT 
		  id, data, title, created, lastdate, location
		FROM DATA_JOB
		WHERE ID = UPPER(#{sid})
	</select>
</mapper>